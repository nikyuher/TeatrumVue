import{d as x,n as V,q as G,g as c,o as d,j as E,k as s,i as U,_ as $,s as T,r as C,e as t,m as z,t as g,l as N,z as O,c as y,C as P,F as J,E as K,b as e,A as L,p as M,f as W,$ as Q,a0 as X}from"./index-t-VuXV_o.js";const Y=x({__name:"CerrarSesion",setup(m){const _=V(),l=G(),i=async()=>{try{_.setUserInfo(null),l.push("/")}catch(u){console.log(u)}};return(u,o)=>{const a=c("v-btn");return d(),E(a,{onClick:i,color:"error",dark:""},{default:s(()=>[U(" Cerrar Sesión ")]),_:1})}}}),D=$(Y,[["__scopeId","data-v-f4ae665b"]]),Z=x({__name:"ChangeName",setup(m){var k;const _=T.baseUrl,l=C(""),i=C(""),u=C(""),o=V(),a=(k=o.userInfo)==null?void 0:k.usuarioId,r=C(""),p=async()=>{var f,v,w;try{if(l.value.trim()===""&&i.value.trim()===""&&u.value.trim()==="")throw r.value="No hay cambios que hacer",setTimeout(()=>{r.value=""},2e3),new Error("No hay cambios que hacer");const n={usuarioId:a,nombre:l.value.trim()!==""?l.value.trim():((f=o.userInfo)==null?void 0:f.nombre)||"",correoElectronico:i.value.trim()!==""?i.value.trim():((v=o.userInfo)==null?void 0:v.correoElectronico)||""},b=await fetch(`${_}/Usuario/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!b.ok)throw new Error("Fallo al Hacer cambios.");const h={usuarioId:a!==void 0?a:0,rol:((w=o.userInfo)==null?void 0:w.rol)!==void 0?o.userInfo.rol:!1,nombre:n.nombre,correoElectronico:n.correoElectronico};b.ok&&(o.setUserInfo(h),r.value="Guardado Correctamente",l.value="",i.value="",u.value="",setTimeout(()=>{r.value=""},2e3))}catch(n){r.value="El valor ya esta en Uso",setTimeout(()=>{r.value=""},2e3),console.log(n)}};return(f,v)=>{const w=c("v-card-title"),n=c("v-text-field"),b=c("v-btn"),h=c("v-form"),I=c("v-alert"),q=c("v-card-text"),B=c("v-card"),H=c("v-container");return d(),E(H,null,{default:s(()=>[t(B,{class:"ma-8"},{default:s(()=>[t(w,{class:"headline"},{default:s(()=>[U("Cambiar Información")]),_:1}),t(q,null,{default:s(()=>[t(h,{onSubmit:z(p,["prevent"])},{default:s(()=>[t(n,{modelValue:l.value,"onUpdate:modelValue":v[0]||(v[0]=S=>l.value=S),label:"Nombre",placeholder:"Nombre Usuario"},null,8,["modelValue"]),t(n,{modelValue:i.value,"onUpdate:modelValue":v[1]||(v[1]=S=>i.value=S),label:"Correo Electrónico",placeholder:"correo@gmail.com",type:"email"},null,8,["modelValue"]),t(n,{modelValue:u.value,"onUpdate:modelValue":v[2]||(v[2]=S=>u.value=S),label:"Contraseña",placeholder:"Contraseña",type:"password"},null,8,["modelValue"]),t(b,{class:"mr-4",type:"submit",color:"primary"},{default:s(()=>[U("Guardar")]),_:1})]),_:1}),r.value?(d(),E(I,{key:0,value:!0,type:r.value.includes("Guardado")?"success":"error"},{default:s(()=>[U(g(r.value),1)]),_:1},8,["type"])):N("",!0)]),_:1})]),_:1})]),_:1})}}}),j=$(Z,[["__scopeId","data-v-72b0822a"]]),ee=x({__name:"InfoUser",setup(m){const _=V(),l=O(()=>{var i,u,o;return[{label:"Rol",value:(i=_.userInfo)!=null&&i.rol?"Administrador":"Usuario"},{label:"Nombre",value:(u=_.userInfo)==null?void 0:u.nombre},{label:"Correo",value:(o=_.userInfo)==null?void 0:o.correoElectronico}]});return(i,u)=>{const o=c("v-card-title"),a=c("v-col"),r=c("v-row"),p=c("v-container"),k=c("v-card-text"),f=c("v-card");return d(),E(f,{class:"info-card"},{default:s(()=>[t(o,{class:"info-title"},{default:s(()=>[U("Detalles del Usuario")]),_:1}),t(k,null,{default:s(()=>[t(p,null,{default:s(()=>[(d(!0),y(J,null,P(l.value,v=>(d(),E(r,{key:v.label,class:"info-row"},{default:s(()=>[t(a,{cols:"4",class:"info-label"},{default:s(()=>[U(g(v.label)+":",1)]),_:2},1024),t(a,{cols:"8",class:"info-value"},{default:s(()=>[U(g(v.value),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}}}),A=$(ee,[["__scopeId","data-v-7fa306ef"]]),oe={class:"ajustar"},te=x({__name:"ReservaDelete",props:{idReserva:{}},emits:["confirmacion"],setup(m,{emit:_}){const l=m,i=_,u=T.baseUrl,o=C(""),a=async r=>{try{if(!l.idReserva)throw o.value="Error con la Optencion del ID.",new Error("Error con la Optencion del ID.");if(!(await fetch(`${u}/Reserva?id=${l.idReserva}`,{method:"DELETE",headers:{"Content-Type":"application/json"}})).ok)throw o.value="Error del Servidor",new Error("Error del Servidor");o.value="Eliminado Correctamente.",setTimeout(()=>{o.value=""},3e3),i("confirmacion",r)}catch(p){o.value="Fallo al Eliminar Reserva.",console.error(p)}};return(r,p)=>{const k=c("v-icon"),f=c("v-btn"),v=c("v-alert"),w=c("v-card-text"),n=c("v-card"),b=c("v-dialog");return d(),E(b,{"max-width":"500"},{activator:s(({props:h})=>[t(f,K(h,{rounded:""}),{default:s(()=>[t(k,{color:"white",size:"20"},{default:s(()=>[U(" mdi-delete ")]),_:1})]),_:2},1040)]),default:s(({isActive:h})=>[t(n,{title:"¿Seguro que quieres Eliminarlo?"},{default:s(()=>[t(w,null,{default:s(()=>[e("div",oe,[t(f,{onClick:p[0]||(p[0]=I=>a(!0)),type:"submit",text:"Si",class:"bg-blue-darken-1"}),t(f,{text:"No",onClick:I=>h.value=!1},null,8,["onClick"])]),o.value?(d(),E(v,{key:0,value:!0,type:o.value.includes("Correctamente")?"success":"error"},{default:s(()=>[U(g(o.value),1)]),_:1},8,["type"])):N("",!0)]),_:2},1024)]),_:2},1024)]),_:1})}}}),ae=$(te,[["__scopeId","data-v-67567dae"]]),ne=m=>(M("data-v-27f85b33"),m=m(),W(),m),re={class:"contenedor"},se=ne(()=>e("h2",null,"Listado de Reservas",-1)),le=["src"],ce=x({__name:"ListaReservas",setup(m){var w;const l=(w=V().userInfo)==null?void 0:w.usuarioId,i=T.baseUrl,u=C(0),o=C([]),a=[{title:"Imagen",value:"obra.imagen"},{title:"Título",value:"obra.título"},{title:"Género",value:"obra.genero"},{title:"Fecha y Hora",value:"obra.fechaHora"},{title:"Asiento",value:"asiento.nombreAsiento"},{title:"Precio",value:"obra.precioEntrada"}],r=async()=>{try{const n=await fetch(`${i}/Reserva/usuario?id=${l}`);if(!n.ok)throw new Error("No se pudo obtener data");const b=await n.json();o.value=b}catch(n){console.log(n)}},p=n=>`data:image/jpeg;base64,${n}`,k=n=>{const b=new Date(n),h={weekday:"long",month:"long",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0};return b.toLocaleDateString("es-ES",h)},f=n=>{n&&(u.value+=1,r())};L(r);const v=n=>{f(n)};return(n,b)=>{const h=c("v-data-table");return d(),y("div",re,[se,(d(),E(h,{class:"ajustar",key:u.value,headers:a,items:o.value,"item-key":"reservaId"},{item:s(({item:I})=>[e("tr",null,[e("td",null,[e("img",{src:p(I.obra.imagen),alt:"Imagen de la obra",height:"50"},null,8,le)]),e("td",null,g(I.obra.título),1),e("td",null,g(I.obra.genero),1),e("td",null,g(k(I.obra.fechaHora)),1),e("td",null,g(I.asiento.nombreAsiento),1),e("td",null,"$"+g(I.obra.precioEntrada),1),t(ae,{"id-reserva":I.reservaId,onConfirmacion:v},null,8,["id-reserva"])])]),_:1},8,["items"]))])}}}),F=$(ce,[["__scopeId","data-v-27f85b33"]]),R=m=>(M("data-v-528482a8"),m=m(),W(),m),ie={key:0},ue={class:"navMobil"},de={key:0,class:"form-box"},_e=R(()=>e("h2",null,"Reservas",-1)),ve={key:1,class:"form-box"},me=R(()=>e("h2",null,"Información Usuario",-1)),pe={key:2,class:"form-box"},fe=R(()=>e("h2",null,"Cambiar Información",-1)),be={key:1,class:"container"},he={class:"wrapper"},Ie={key:0,class:"form-box"},ye=R(()=>e("h2",null,"Reservas",-1)),we={key:1,class:"form-box"},ge=R(()=>e("h2",null,"Información Usuario",-1)),Ce={key:2,class:"form-box"},Ue=R(()=>e("h2",null,"Cambiar Información",-1)),ke=x({__name:"SettingUser",setup(m){const _=C("info"),l=o=>{_.value=o},i=C(window.innerWidth),u=()=>{i.value=window.innerWidth};return L(()=>{window.addEventListener("resize",u)}),Q(()=>{u()}),X(i,o=>{}),(o,a)=>(d(),y("main",null,[i.value<=875?(d(),y("div",ie,[e("div",ue,[e("nav",null,[e("ul",null,[e("li",{onClick:a[0]||(a[0]=r=>l("info"))},"Información Usuario"),e("li",{onClick:a[1]||(a[1]=r=>l("change"))},"Cambiar Información"),e("li",{onClick:a[2]||(a[2]=r=>l("reserva"))},"Reservas"),e("li",null,[t(D)])])])]),e("article",null,[e("section",null,[_.value==="reserva"?(d(),y("div",de,[_e,t(F)])):_.value==="info"?(d(),y("div",ve,[me,t(A)])):_.value==="change"?(d(),y("div",pe,[fe,t(j)])):N("",!0)])])])):(d(),y("div",be,[e("nav",null,[e("ul",null,[e("li",{onClick:a[3]||(a[3]=r=>l("info"))},"Información Usuario"),e("li",{onClick:a[4]||(a[4]=r=>l("change"))},"Cambiar Información"),e("li",{onClick:a[5]||(a[5]=r=>l("reserva"))},"Reservas"),e("li",null,[t(D)])])]),e("article",he,[e("section",null,[_.value==="reserva"?(d(),y("div",Ie,[ye,t(F)])):_.value==="info"?(d(),y("div",we,[ge,t(A)])):_.value==="change"?(d(),y("div",Ce,[Ue,t(j)])):N("",!0)])])]))]))}}),xe=$(ke,[["__scopeId","data-v-528482a8"]]);export{xe as default};
