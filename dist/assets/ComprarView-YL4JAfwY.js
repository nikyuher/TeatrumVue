import{x as D,_ as C,o,c as n,a as Z,d as j,r as R,y as U,z as F,g as O,w as G,A as L,b as e,F as k,B as x,j as f,s as B,e as i,k as g,p as P,f as z,t as H,n as te,m as se,i as K,u as ae}from"./index-sLd-t8Qj.js";const ee=D({id:"infoButaca",state:()=>({butacas:null}),actions:{setButacas(t){this.butacas=t}}}),oe=D("infoAsientos",{state:()=>({asientos:[]}),actions:{setAsientos(t){this.asientos=t}}}),ne={},re={width:"100",height:"100",viewBox:"0 50 200 200"},ie=Z('<rect x="50" y="150" width="100" height="20" fill="grey"></rect><rect x="57" y="110" width="85" height="40" fill="grey"></rect><rect x="64" y="110" width="70" height="40" fill="red"></rect><rect x="60" y="170" width="10" height="30" fill="black"></rect><rect x="130" y="170" width="10" height="30" fill="black"></rect>',5),ce=[ie];function le(t,I){return o(),n("svg",re,ce)}const S=C(ne,[["render",le]]),de={},ue={width:"100",height:"100",viewBox:"0 50 200 200"},_e=Z('<rect x="50" y="150" width="100" height="20" fill="grey"></rect><rect x="57" y="110" width="85" height="40" fill="grey"></rect><rect x="64" y="110" width="70" height="40" fill="green"></rect><rect x="60" y="170" width="10" height="30" fill="black"></rect><rect x="130" y="170" width="10" height="30" fill="black"></rect>',5),he=[_e];function ve(t,I){return o(),n("svg",ue,he)}const E=C(de,[["render",ve]]),T=t=>(P("data-v-c2bd6770"),t=t(),z(),t),pe={class:"cosa"},be=T(()=>e("h3",null,"Grupo A",-1)),fe={class:"bloqueA"},me={class:"box"},we=T(()=>e("h3",null,"Grupo B",-1)),ye={class:"bloqueB"},Ie={class:"box"},$e=T(()=>e("h3",null,"Grupo C",-1)),ke={class:"bloqueC"},ge={class:"cosa2"},Oe=T(()=>e("h3",null,"Grupo A",-1)),Ce={class:"bloqueA"},Ae={class:"box"},xe=T(()=>e("h3",null,"Grupo B",-1)),Be={class:"bloqueB"},Se={class:"box"},Ee=T(()=>e("h3",null,"Grupo C",-1)),Re={class:"bloqueC"},Te=j({__name:"ListaButacas",props:{idObra:{}},setup(t){const I=t,l=R([]),w=ee(),_=oe(),m=U(()=>_.asientos),d=I.idObra,v=R();F(()=>{window.addEventListener("resize",y),y()});const y=()=>{window.innerWidth<=1060?v.value=!1:v.value=!0};F(async()=>{try{const a=await fetch("http://localhost:8001/Asiento/estado/false"),r=await fetch(`http://localhost:8001/Obra/${d}/asientos`);if(!a.ok||!r.ok)throw new Error("No se pudo obtener data");const c=await a.json();(await r.json()).asientosOcupados.forEach(s=>{const b=c.findIndex(N=>N.nombreAsiento===s.nombreAsiento);b!==-1&&(c[b].estado=s.estado)}),l.value=c,_.setAsientos(c)}catch(a){console.log("Error al cargar las butacas",a)}});const $=async a=>{try{const r=await fetch(`http://localhost:8001/Asiento/${a}`);if(!r.ok)throw new Error("No se pudo obtener la data");const c=await r.json(),p={asientoId:c.asientoId,nombreAsiento:c.nombreAsiento,estado:c.estado};w.setButacas(p)}catch(r){console.error("Error al obtener la butaca:",r)}},u=a=>{$(a)},h=a=>m.value.filter(r=>r.nombreAsiento.startsWith(a));return(a,r)=>{const c=O("v-carousel-item"),p=O("v-carousel");return o(),n(k,null,[G(e("div",pe,[e("div",null,[be,e("div",fe,[(o(!0),n(k,null,x(h("A"),s=>(o(),n("div",{key:s.asientoId},[e("div",me,[s.estado?(o(),f(S,{key:0,class:B("cursor-not-allowed")})):(o(),f(E,{key:1,onClick:b=>u(s.asientoId)},null,8,["onClick"]))])]))),128))])]),e("div",null,[we,e("div",ye,[(o(!0),n(k,null,x(h("B"),s=>(o(),n("div",{key:s.asientoId},[e("div",Ie,[s.estado?(o(),f(S,{key:0,class:B("cursor-not-allowed")})):(o(),f(E,{key:1,onClick:b=>u(s.asientoId)},null,8,["onClick"]))])]))),128))])]),e("div",null,[$e,e("div",ke,[(o(!0),n(k,null,x(h("C"),s=>(o(),n("div",{key:s.asientoId},[e("div",null,[s.estado?(o(),f(S,{key:0,class:B("cursor-not-allowed")})):(o(),f(E,{key:1,onClick:b=>u(s.asientoId)},null,8,["onClick"]))])]))),128))])])],512),[[L,v.value]]),G(e("div",null,[i(p,{"hide-delimiters":""},{default:g(()=>[e("div",ge,[i(c,null,{default:g(()=>[e("div",null,[Oe,e("div",Ce,[(o(!0),n(k,null,x(h("A"),s=>(o(),n("div",{key:s.asientoId},[e("div",Ae,[s.estado?(o(),f(S,{key:0,class:B("cursor-not-allowed")})):(o(),f(E,{key:1,onClick:b=>u(s.asientoId)},null,8,["onClick"]))])]))),128))])])]),_:1}),i(c,null,{default:g(()=>[e("div",null,[xe,e("div",Be,[(o(!0),n(k,null,x(h("B"),s=>(o(),n("div",{key:s.asientoId},[e("div",Se,[s.estado?(o(),f(S,{key:0,class:B("cursor-not-allowed")})):(o(),f(E,{key:1,onClick:b=>u(s.asientoId)},null,8,["onClick"]))])]))),128))])])]),_:1}),i(c,null,{default:g(()=>[e("div",null,[Ee,e("div",Re,[(o(!0),n(k,null,x(h("C"),s=>(o(),n("div",{key:s.asientoId},[e("div",null,[s.estado?(o(),f(S,{key:0,class:B("cursor-not-allowed")})):(o(),f(E,{key:1,onClick:b=>u(s.asientoId)},null,8,["onClick"]))])]))),128))])])]),_:1})])]),_:1})],512),[[L,!v.value]])],64)}}}),Q=C(Te,[["__scopeId","data-v-c2bd6770"]]),J=D({id:"obraInfo",state:()=>({infoObra:null}),actions:{setObraInfo(t){this.infoObra=t}}}),Ne=t=>(P("data-v-078303a9"),t=t(),z(),t),je={key:0},qe={key:1},Ve=Ne(()=>e("p",null,"No se encontró ninguna obra para mostrar.",-1)),Ue=[Ve],Fe=j({__name:"ObraEspecificaId",props:{idObra:{}},setup(t){const I=t,l=R(null),w=I.idObra,_=J();F(async()=>{try{const d=await fetch(`http://localhost:8001/Obra/${w}`);if(!d.ok)throw new Error("No se pudo obtener la data");const v=await d.json();l.value=v;const y={idObra:l.value.obraId,titulo:l.value.título,precio:l.value.precioEntrada,imagen:m(l.value.imagen)};_.setObraInfo(y)}catch(d){console.error("Error al obtener la obra:",d)}});const m=d=>{const y=($=>{const u=window.atob($),h=u.length,a=new Uint8Array(h);for(let r=0;r<h;r++)a[r]=u.charCodeAt(r);return new Blob([a],{type:"image/png"})})(d);return URL.createObjectURL(y)};return(d,v)=>l.value?(o(),n("div",je,[e("h1",null,H(l.value.título),1),e("p",null,H(l.value.descripción),1)])):(o(),n("div",qe,Ue))}}),X=C(Fe,[["__scopeId","data-v-078303a9"]]),W=t=>(P("data-v-59115f7a"),t=t(),z(),t),Ge=W(()=>e("h2",null,"Reserva Asiento",-1)),Le={class:"contenidoForm"},Pe={class:"datosForm"},ze=W(()=>e("label",null,"Obra de Teatro ",-1)),We=W(()=>e("label",null,"Sitio de Asiento:",-1)),De=W(()=>e("label",null,"Precio:$",-1)),Je=j({__name:"TicketReserva",props:{idObra:{}},setup(t){var a;const l=t.idObra,w=te(),_=J(),m=U(()=>_.infoObra),d=ee(),v=U(()=>d.butacas),y=oe(),$=(a=w.userInfo)==null?void 0:a.usuarioId,u=R(!1),h=async()=>{var r,c;try{if(((r=w.userInfo)==null?void 0:r.usuarioId)==null)return alert("Tienes que Iniciar Sesion para Comprar.");const p={usuarioId:$,obraId:l};if(!(await fetch(`http://localhost:8001/Reserva/${$}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})).ok)throw new Error("Fallo al Hacer la reserva");const b={asientoId:(c=d.butacas)==null?void 0:c.asientoId,obraId:l};if((await fetch("http://localhost:8001/Asiento/ocupados",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})).ok){const q=y.asientos.map(A=>{var V;return A.nombreAsiento===((V=d.butacas)==null?void 0:V.nombreAsiento)?{...A,estado:!0}:A});y.setAsientos(q),u.value=!0,d.setButacas(null)}else throw new Error("Fallo al actualizar el estado del asiento.")}catch(p){console.log(p)}};return(r,c)=>{var N,q,A;const p=O("v-text-field"),s=O("v-btn"),b=O("v-snackbar");return o(),n(k,null,[Ge,e("div",Le,[e("form",{onSubmit:se(h,["prevent"])},[e("div",Pe,[ze,i(p,{type:"text",id:"inputNombreObra",value:(N=m.value)==null?void 0:N.titulo},null,8,["value"]),We,i(p,{type:"text",id:"inputSitioAsiento",required:"",value:(q=v.value)==null?void 0:q.nombreAsiento},null,8,["value"]),De,i(p,{type:"number",id:"inputPrecio",value:(A=m.value)==null?void 0:A.precio},null,8,["value"])]),i(s,{type:"submit"},{default:g(()=>[K(" Comprar ")]),_:1})],32)]),i(b,{modelValue:u.value,"onUpdate:modelValue":c[0]||(c[0]=V=>u.value=V),color:"success",timeout:"2000"},{default:g(()=>[K(" Comprado correctamente ")]),_:1},8,["modelValue"])],64)}}}),Y=C(Je,[["__scopeId","data-v-59115f7a"]]),M=t=>(P("data-v-7c774807"),t=t(),z(),t),Me={class:"contenedorComprar"},He={class:"contImagenObraPopular"},Ke=["src"],Qe={class:"descripcionCompra"},Xe={class:"formComprar"},Ye={class:"contenedorBloques"},Ze={class:"cosa2"},eo={class:"contenedorComprar2"},oo=M(()=>e("h1",null,"Informacion Obra",-1)),to={class:"cosa2"},so={class:"contImagenObraPopular"},ao=["src"],no={class:"descripcionCompra2"},ro=M(()=>e("h1",null,"Informacion Asientos",-1)),io={class:"contenedorBloques"},co=M(()=>e("h1",null,"Comprar",-1)),lo={class:"formComprar"},uo=j({__name:"ReservarObra",setup(t){const I=J(),l=U(()=>I.infoObra),w=ae(),_=R(0);_.value=Array.isArray(w.params.idObra)?parseInt(w.params.idObra[0]):parseInt(w.params.idObra);const m=R();F(()=>{window.addEventListener("resize",d),d()});const d=()=>{window.innerWidth<=1060?m.value=!1:m.value=!0};return(v,y)=>{var h;const $=O("v-carousel-item"),u=O("v-carousel");return o(),n(k,null,[G(e("div",null,[e("div",Me,[e("div",He,[e("img",{src:(h=l.value)==null?void 0:h.imagen,alt:"Imagen de la obra"},null,8,Ke)]),e("div",Qe,[i(X,{"id-obra":_.value},null,8,["id-obra"])]),e("div",Xe,[i(Y,{"id-obra":_.value},null,8,["id-obra"])])]),e("div",Ye,[i(Q,{"id-obra":_.value},null,8,["id-obra"])])],512),[[L,m.value]]),G(e("div",null,[e("div",Ze,[e("div",eo,[oo,i(u,{"hide-delimiters":""},{default:g(()=>[e("div",to,[i($,null,{default:g(()=>{var a;return[e("div",so,[e("img",{src:(a=l.value)==null?void 0:a.imagen,alt:"Imagen de la obra"},null,8,ao)])]}),_:1}),i($,null,{default:g(()=>[e("div",no,[i(X,{"id-obra":_.value},null,8,["id-obra"])])]),_:1})])]),_:1})]),ro,e("div",io,[i(Q,{"id-obra":_.value},null,8,["id-obra"])]),co,e("div",lo,[i(Y,{"id-obra":_.value},null,8,["id-obra"])])])],512),[[L,!m.value]])],64)}}}),_o=C(uo,[["__scopeId","data-v-7c774807"]]),ho=j({__name:"ComprarView",setup(t){return(I,l)=>(o(),n("main",null,[e("article",null,[e("section",null,[i(_o)])])]))}}),po=C(ho,[["__scopeId","data-v-38e675d1"]]);export{po as default};
