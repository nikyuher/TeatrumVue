import{y as Y,_ as j,o,c as s,a as Z,d as L,s as ee,r as U,z as F,A as W,g as B,w as J,B as M,b as t,F as i,C as S,t as v,e as n,x as R,k as c,p as G,f as K,q as ce,n as de,i as V,D as Q,E as ue,j as se,m as _e,u as he}from"./index-t-VuXV_o.js";const X=Y({id:"infoButaca",state:()=>({butacasSeleccionadas:[]}),actions:{ButacasSeleccionadas(a){const x=this.butacasSeleccionadas.findIndex(C=>C.asientoId===a.asientoId);x===-1?this.butacasSeleccionadas.push({...a,cantidad:1}):this.butacasSeleccionadas.splice(x,1)}}}),re=Y("infoAsientos",{state:()=>({asientos:[]}),actions:{setAsientos(a){this.asientos=a}}}),ve={},pe={width:"100",height:"100",viewBox:"0 50 200 200"},me=Z('<rect x="50" y="150" width="100" height="20" fill="grey"></rect><rect x="57" y="110" width="85" height="40" fill="grey"></rect><rect x="64" y="110" width="70" height="40" fill="red"></rect><rect x="60" y="170" width="10" height="30" fill="black"></rect><rect x="130" y="170" width="10" height="30" fill="black"></rect>',5),fe=[me];function be(a,x){return o(),s("svg",pe,fe)}const N=j(ve,[["render",be]]),ye={},Ie={width:"100",height:"100",viewBox:"0 50 200 200"},ke=Z('<rect x="50" y="150" width="100" height="20" fill="grey"></rect><rect x="57" y="110" width="85" height="40" fill="grey"></rect><rect x="64" y="110" width="70" height="40" fill="green"></rect><rect x="60" y="170" width="10" height="30" fill="black"></rect><rect x="130" y="170" width="10" height="30" fill="black"></rect>',5),we=[ke];function xe(a,x){return o(),s("svg",Ie,we)}const z=j(ye,[["render",xe]]),Ae={},$e={width:"100",height:"100",viewBox:"0 50 200 200"},ge=Z('<rect x="50" y="150" width="100" height="20" fill="grey"></rect><rect x="57" y="110" width="85" height="40" fill="grey"></rect><rect x="64" y="110" width="70" height="40" fill="blue"></rect><rect x="60" y="170" width="10" height="30" fill="black"></rect><rect x="130" y="170" width="10" height="30" fill="black"></rect>',5),Ce=[ge];function Oe(a,x){return o(),s("svg",$e,Ce)}const P=j(Ae,[["render",Oe]]),q=a=>(G("data-v-36019248"),a=a(),K(),a),Se=q(()=>t("div",{class:"pantalla"},[t("h1",null,"Pantalla")],-1)),Be={class:"cosa"},Ee=q(()=>t("h3",null,"Lateral Izquierdo",-1)),Te={class:"box"},je={class:"text-style"},Ue={class:"text-style"},qe={class:"text-style"},Re=q(()=>t("h3",null,"Centro",-1)),Ve={class:"box"},Ne={class:"text-style"},ze={class:"text-style"},Pe={class:"text-style"},De=q(()=>t("h3",null,"Lateral Derecho",-1)),Fe={class:"box"},Le={class:"text-style"},He={class:"text-style"},We={class:"text-style"},Je={class:"cosa2"},Me=q(()=>t("h3",null,"Lateral Izquierdo",-1)),Ge={class:"box"},Ke={class:"text-style"},Qe={class:"text-style"},Xe={class:"text-style"},Ye=q(()=>t("h3",null,"Centro",-1)),Ze={class:"box"},et={class:"text-style"},tt={class:"text-style"},ot={class:"text-style"},st=q(()=>t("h3",null,"Lateral Derecho",-1)),nt={class:"box"},at={class:"text-style"},it={class:"text-style"},rt={class:"text-style"},lt=L({__name:"ListaButacas",props:{idObra:{}},setup(a){const x=a,C=X(),m=ee.baseUrl,A=U([]),O=X(),E=re(),y=F(()=>E.asientos),g=x.idObra,b=U();W(()=>{window.addEventListener("resize",T),T()});const T=()=>{window.innerWidth<=1060?b.value=!1:b.value=!0};W(async()=>{try{C.butacasSeleccionadas=[];const u=await fetch(`${m}/Asiento/disponible?estado=false`),r=await fetch(`${m}/Obra/${g}/asientos`);if(!u.ok||!r.ok)throw new Error("No se pudo obtener data");const h=await u.json();(await r.json()).asientosOcupados.forEach(l=>{const e=h.findIndex(_=>_.nombreAsiento===l.nombreAsiento);e!==-1&&(h[e].estado=l.estado)}),A.value=h,E.setAsientos(h)}catch(u){console.log("Error al cargar las butacas",u)}});const I=async u=>{try{const r=await fetch(`${m}/Asiento/${u}`);if(!r.ok)throw new Error("No se pudo obtener la data");const h=await r.json(),w={asientoId:h.asientoId,nombreAsiento:h.nombreAsiento,estado:h.estado};O.ButacasSeleccionadas(w)}catch(r){console.error("Error al obtener la butaca:",r)}},p=u=>{I(u)},$=u=>y.value.filter(r=>r.nombreAsiento.startsWith(u)),f=U([]),d=u=>{const r=f.value.indexOf(u);r===-1?f.value.push(u):f.value.splice(r,1)},k=u=>{const r={};return u.forEach(h=>{const w=h.nombreAsiento.charAt(0);r[w]||(r[w]=[]),r[w].push(h)}),Object.keys(r).forEach(h=>{r[h].sort((w,l)=>{const e=parseInt(w.nombreAsiento.substring(1)),_=parseInt(l.nombreAsiento.substring(1));return e-_})}),Object.values(r)};return(u,r)=>{const h=B("v-carousel-item"),w=B("v-carousel");return o(),s(i,null,[Se,J(t("div",Be,[t("div",null,[Ee,(o(!0),s(i,null,S(k($("A")),l=>(o(),s("div",{class:"bloqueA",key:l[0].nombreAsiento.charAt(0)},[(o(!0),s(i,null,S(l,e=>(o(),s("div",{key:e.asientoId},[t("div",Te,[e.estado?(o(),s(i,{key:0},[t("p",je,v(e.nombreAsiento),1),n(N,{class:R("cursor-not-allowed")})],64)):f.value.includes(e.asientoId)?(o(),s(i,{key:2},[t("p",qe,v(e.nombreAsiento),1),n(P,{onClick:_=>{p(e.asientoId),d(e.asientoId)}},null,8,["onClick"])],64)):(o(),s(i,{key:1},[t("p",Ue,v(e.nombreAsiento),1),n(z,{onClick:_=>{p(e.asientoId),d(e.asientoId)}},null,8,["onClick"])],64))])]))),128))]))),128))]),t("div",null,[Re,(o(!0),s(i,null,S(k($("B")),l=>(o(),s("div",{class:"bloqueB",key:l[0].nombreAsiento.charAt(0)},[(o(!0),s(i,null,S(l,e=>(o(),s("div",{key:e.asientoId},[t("div",Ve,[e.estado?(o(),s(i,{key:0},[t("p",Ne,v(e.nombreAsiento),1),n(N,{class:R("cursor-not-allowed")})],64)):f.value.includes(e.asientoId)?(o(),s(i,{key:2},[t("p",Pe,v(e.nombreAsiento),1),n(P,{onClick:_=>{p(e.asientoId),d(e.asientoId)}},null,8,["onClick"])],64)):(o(),s(i,{key:1},[t("p",ze,v(e.nombreAsiento),1),n(z,{onClick:_=>{p(e.asientoId),d(e.asientoId)}},null,8,["onClick"])],64))])]))),128))]))),128))]),t("div",null,[De,(o(!0),s(i,null,S(k($("C")),l=>(o(),s("div",{class:"bloqueC",key:l[0].nombreAsiento.charAt(0)},[(o(!0),s(i,null,S(l,e=>(o(),s("div",{key:e.asientoId},[t("div",Fe,[e.estado?(o(),s(i,{key:0},[t("p",Le,v(e.nombreAsiento),1),n(N,{class:R("cursor-not-allowed")})],64)):f.value.includes(e.asientoId)?(o(),s(i,{key:2},[t("p",We,v(e.nombreAsiento),1),n(P,{onClick:_=>{p(e.asientoId),d(e.asientoId)}},null,8,["onClick"])],64)):(o(),s(i,{key:1},[t("p",He,v(e.nombreAsiento),1),n(z,{onClick:_=>{p(e.asientoId),d(e.asientoId)}},null,8,["onClick"])],64))])]))),128))]))),128))])],512),[[M,b.value]]),J(t("div",null,[n(w,{"hide-delimiters":""},{default:c(()=>[t("div",Je,[n(h,null,{default:c(()=>[t("div",null,[Me,(o(!0),s(i,null,S(k($("A")),l=>(o(),s("div",{class:"bloqueA",key:l[0].nombreAsiento.charAt(0)},[(o(!0),s(i,null,S(l,e=>(o(),s("div",{key:e.asientoId},[t("div",Ge,[e.estado?(o(),s(i,{key:0},[t("p",Ke,v(e.nombreAsiento),1),n(N,{class:R("cursor-not-allowed")})],64)):f.value.includes(e.asientoId)?(o(),s(i,{key:2},[t("p",Xe,v(e.nombreAsiento),1),n(P,{onClick:_=>{p(e.asientoId),d(e.asientoId)}},null,8,["onClick"])],64)):(o(),s(i,{key:1},[t("p",Qe,v(e.nombreAsiento),1),n(z,{onClick:_=>{p(e.asientoId),d(e.asientoId)}},null,8,["onClick"])],64))])]))),128))]))),128))])]),_:1}),n(h,null,{default:c(()=>[t("div",null,[Ye,(o(!0),s(i,null,S(k($("B")),l=>(o(),s("div",{class:"bloqueB",key:l[0].nombreAsiento.charAt(0)},[(o(!0),s(i,null,S(l,e=>(o(),s("div",{key:e.asientoId},[t("div",Ze,[e.estado?(o(),s(i,{key:0},[t("p",et,v(e.nombreAsiento),1),n(N,{class:R("cursor-not-allowed")})],64)):f.value.includes(e.asientoId)?(o(),s(i,{key:2},[t("p",ot,v(e.nombreAsiento),1),n(P,{onClick:_=>{p(e.asientoId),d(e.asientoId)}},null,8,["onClick"])],64)):(o(),s(i,{key:1},[t("p",tt,v(e.nombreAsiento),1),n(z,{onClick:_=>{p(e.asientoId),d(e.asientoId)}},null,8,["onClick"])],64))])]))),128))]))),128))])]),_:1}),n(h,null,{default:c(()=>[t("div",null,[st,(o(!0),s(i,null,S(k($("C")),l=>(o(),s("div",{class:"bloqueC",key:l[0].nombreAsiento.charAt(0)},[(o(!0),s(i,null,S(l,e=>(o(),s("div",{key:e.asientoId},[t("div",nt,[e.estado?(o(),s(i,{key:0},[t("p",at,v(e.nombreAsiento),1),n(N,{class:R("cursor-not-allowed")})],64)):f.value.includes(e.asientoId)?(o(),s(i,{key:2},[t("p",rt,v(e.nombreAsiento),1),n(P,{onClick:_=>{p(e.asientoId),d(e.asientoId)}},null,8,["onClick"])],64)):(o(),s(i,{key:1},[t("p",it,v(e.nombreAsiento),1),n(z,{onClick:_=>{p(e.asientoId),d(e.asientoId)}},null,8,["onClick"])],64))])]))),128))]))),128))])]),_:1})])]),_:1})],512),[[M,!b.value]])],64)}}}),ne=j(lt,[["__scopeId","data-v-36019248"]]),te=Y({id:"obraInfo",state:()=>({infoObra:null}),actions:{setObraInfo(a){this.infoObra=a}}}),ct=a=>(G("data-v-a48c02f7"),a=a(),K(),a),dt={key:0},ut={key:1},_t=ct(()=>t("p",null,"No se encontró ninguna obra para mostrar.",-1)),ht=[_t],vt=L({__name:"ObraEspecificaId",props:{idObra:{}},setup(a){const x=ee.baseUrl,C=a,m=U(null),A=C.idObra,O=te();W(async()=>{try{const y=await fetch(`${x}/Obra/${A}`);if(!y.ok)throw new Error("No se pudo obtener la data");const g=await y.json();m.value=g;const b={idObra:m.value.obraId,titulo:m.value.título,precio:m.value.precioEntrada,fechaHora:m.value.fechaHora,imagen:E(m.value.imagen)};O.setObraInfo(b)}catch(y){console.error("Error al obtener la obra:",y)}});const E=y=>{const b=(T=>{const I=window.atob(T),p=I.length,$=new Uint8Array(p);for(let f=0;f<p;f++)$[f]=I.charCodeAt(f);return new Blob([$],{type:"image/png"})})(y);return URL.createObjectURL(b)};return(y,g)=>m.value?(o(),s("div",dt,[t("h1",null,v(m.value.título),1),t("p",null,v(m.value.descripción),1)])):(o(),s("div",ut,ht))}}),ae=j(vt,[["__scopeId","data-v-a48c02f7"]]),D=a=>(G("data-v-2a618890"),a=a(),K(),a),pt={class:"datosForm"},mt=D(()=>t("label",null,"Obra de Teatro ",-1)),ft=D(()=>t("label",null,"Sitio de Asiento:",-1)),bt=D(()=>t("label",null,"Dìa y hora",-1)),yt=D(()=>t("label",null,"Precio:",-1)),It=D(()=>t("h1",null,"Tienes que Iniciar Sesión",-1)),kt=D(()=>t("h1",null,"Comprado Exitosamente",-1)),wt=L({__name:"TicketReserva",props:{idObra:{}},setup(a){var d;const x=ce(),C=ee.baseUrl,A=a.idObra,O=de(),E=te(),y=F(()=>E.infoObra),g=X(),b=re(),T=(d=O.userInfo)==null?void 0:d.usuarioId,I=F(()=>g.butacasSeleccionadas.map(k=>k.nombreAsiento).join(", ")),p=F(()=>y.value?y.value.precio*g.butacasSeleccionadas.length:0),$=async()=>{var k,u;try{if(((k=O.userInfo)==null?void 0:k.usuarioId)===null||((u=O.userInfo)==null?void 0:u.usuarioId)===void 0)throw new Error("Tienes que Iniciar Sesion para Comprar.");const r=g.butacasSeleccionadas.map(e=>({usuarioId:T,obraId:A,asientoId:e.asientoId}));if(!(await fetch(`${C}/Reserva`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok)throw new Error("Fallo al Hacer la reserva");const w=g.butacasSeleccionadas.map(e=>({obraId:A,asientoId:e.asientoId}));if((await fetch(`${C}/Asiento/ocupados`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)})).ok){const e=b.asientos.map(_=>I.value.includes(_.nombreAsiento)?{..._,estado:!0}:_);b.setAsientos(e),g.butacasSeleccionadas=[],setTimeout(()=>{x.push("/catalogo")},1e3)}else throw new Error("Fallo al actualizar el estado del asiento.")}catch(r){console.log(r)}},f=k=>{if(!k)return"";const u=new Date(k),r={weekday:"long",month:"long",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0};return u.toLocaleDateString("es-ES",r)};return(k,u)=>{var oe;const r=B("v-text-field"),h=B("v-btn"),w=B("v-icon"),l=B("v-card-text"),e=B("router-link"),_=B("v-card"),le=B("v-dialog");return o(),s("form",{onSubmit:_e($,["prevent"])},[t("div",pt,[mt,n(r,{type:"text",id:"inputNombreObra",value:(oe=y.value)==null?void 0:oe.titulo},null,8,["value"]),ft,n(r,{type:"text",id:"inputSitioAsiento",value:I.value,readonly:""},null,8,["value"]),bt,n(r,{type:"number"},{default:c(()=>{var H;return[V(v(f((H=Q(E).infoObra)==null?void 0:H.fechaHora)),1)]}),_:1}),yt,n(r,{type:"number",id:"inputPrecio",value:p.value},{default:c(()=>[V("$")]),_:1},8,["value"])]),n(le,{"max-width":"500"},{activator:c(({props:H})=>[n(h,ue({type:"submit"},H,{disabled:I.value==="",style:{backgroundColor:I.value===""?"red":"",color:I.value===""?"white":""}}),{default:c(()=>[V(" Comprar ")]),_:2},1040,["disabled","style"])]),default:c(()=>[Q(T)===null||Q(T)===void 0?(o(),se(_,{key:0,class:"ajustar"},{default:c(()=>[n(w,{color:"red",size:"100"},{default:c(()=>[V(" mdi-close-circle ")]),_:1}),n(l,null,{default:c(()=>[It]),_:1}),n(h,{class:"botonSesion"},{default:c(()=>[n(e,{to:"/login",class:"text-color"},{default:c(()=>[V("Iniciar Sesion")]),_:1})]),_:1})]),_:1})):(o(),se(_,{key:1,class:"ajustar"},{default:c(()=>[n(w,{color:"green",size:"100"},{default:c(()=>[V(" mdi-check-circle ")]),_:1}),n(l,null,{default:c(()=>[kt]),_:1})]),_:1}))]),_:1})],32)}}}),ie=j(wt,[["__scopeId","data-v-2a618890"]]),xt=a=>(G("data-v-63528f7b"),a=a(),K(),a),At={class:"contenedorComprar"},$t={class:"contImagenObraPopular"},gt=["src"],Ct={class:"descripcionCompra"},Ot={class:"contenedorBloques"},St={class:"formComprar"},Bt={class:"contenedorComprar2"},Et=xt(()=>t("h1",null,"Informacion Obra",-1)),Tt={class:"cosa2"},jt={class:"contImagenObraPopular"},Ut=["src"],qt={class:"descripcionCompra2"},Rt={class:"contenedorBloques"},Vt={class:"formComprar"},Nt=L({__name:"ReservarObra",setup(a){const x=te(),C=F(()=>x.infoObra),m=he(),A=U(0);A.value=Array.isArray(m.params.idObra)?parseInt(m.params.idObra[0]):parseInt(m.params.idObra);const O=U();W(()=>{window.addEventListener("resize",E),E()});const E=()=>{window.innerWidth<=1060?O.value=!1:O.value=!0},y=["Información de la Obra","Escoger Butacas","Comprar Tickets"],g=["Información","Butacas","Comprar"],b=U(1);return(T,I)=>{const p=B("v-stepper"),$=B("v-carousel-item"),f=B("v-carousel");return o(),s(i,null,[J(t("div",null,[n(p,{modelValue:b.value,"onUpdate:modelValue":I[0]||(I[0]=d=>b.value=d),items:y,"show-actions":""},{item:c(()=>{var d;return[t("div",At,[t("div",$t,[t("img",{src:(d=C.value)==null?void 0:d.imagen,alt:"Imagen de la obra"},null,8,gt)]),t("div",Ct,[n(ae,{"id-obra":A.value},null,8,["id-obra"])])])]}),"item.2":c(()=>[t("div",Ot,[n(ne,{"id-obra":A.value},null,8,["id-obra"])])]),"item.3":c(()=>[t("div",St,[n(ie,{"id-obra":A.value},null,8,["id-obra"])])]),_:1},8,["modelValue"])],512),[[M,O.value]]),J(t("div",null,[n(p,{modelValue:b.value,"onUpdate:modelValue":I[1]||(I[1]=d=>b.value=d),items:g,"show-actions":""},{item:c(()=>[t("div",Bt,[Et,n(f,{"hide-delimiters":""},{default:c(()=>[t("div",Tt,[n($,null,{default:c(()=>{var d;return[t("div",jt,[t("img",{src:(d=C.value)==null?void 0:d.imagen,alt:"Imagen de la obra"},null,8,Ut)])]}),_:1}),n($,null,{default:c(()=>[t("div",qt,[n(ae,{"id-obra":A.value},null,8,["id-obra"])])]),_:1})])]),_:1})])]),"item.2":c(()=>[t("div",Rt,[n(ne,{"id-obra":A.value},null,8,["id-obra"])])]),"item.3":c(()=>[t("div",Vt,[n(ie,{"id-obra":A.value},null,8,["id-obra"])])]),_:1},8,["modelValue"])],512),[[M,!O.value]])],64)}}}),zt=j(Nt,[["__scopeId","data-v-63528f7b"]]),Pt=L({__name:"ComprarView",setup(a){return(x,C)=>(o(),s("main",null,[t("article",null,[t("section",null,[n(zt)])])]))}}),Ft=j(Pt,[["__scopeId","data-v-38e675d1"]]);export{Ft as default};
